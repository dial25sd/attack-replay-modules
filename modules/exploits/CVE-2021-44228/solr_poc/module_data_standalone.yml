---
name: LOG4SHELL-APACHE-SOLR
module_class: exploit
module_type: standalone 
source: ARF
parameters:
  - name: LHOST
    description: Hostname or IP of the local machine
    value:
      method: arf_arg
      argument: lhost
  - name: LPORT
    description: Port to use for the Out of Band listener
    value:
      method: random
      argument: port
  - name: LISTEN_HOST
    description: Hostname or IP of the exploit executing system
    value_default: 0.0.0.0
  - name: RHOST
    description: Hostname or IP of the vulnerable site
    value:
      method: event_data
      argument: dest_ip
  - name: RPORT
    description: Port of the vulnerable Solr instance
    value:
      method: event_data
      argument: dest_port
  - name: TARGETURI
    description: URI of the SOLR Admin application
    value_default: /solr/admin/cores
    value:
      method: extract
      argument: "^(\\S+)\\?"  # extract everything up to the first URL query param
      input:
        method: event_data
        argument: http.url
success: 
  - strategy: output
    argument: "Error: "
    conclusion: no
  - strategy: output
    argument: "Listener timed out after "
    conclusion: no
  - strategy: output
    argument: "Got connection from "
    conclusion: yes
  - strategy: output
    argument: "Received data: "
    conclusion: yes
  - strategy: fallback
    conclusion: no