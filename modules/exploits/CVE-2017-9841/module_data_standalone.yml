---
name: PHPUNIT4828RCEUNAUTH
module_class: exploit
module_type: standalone 
source: https://www.exploit-db.com/exploits/50702 with modifications for ARF
parameters:
  - name: HOST
    description: Host of the vulnerable site
    value:
      method: assemble
      argument: "{proto}://{host}:{port}"
      input:
        - name: proto
          method: event_data
          argument: app_proto
        - name: host
          method: exists
          argument:
          input:
            - method: event_data
              argument: http.hostname
            - method: event_data
              argument: dest_ip
        - name: port
          method: event_data
          argument: dest_port
  - name: CMD
    description: command to be executed on target system
    value_default: "echo attack-replay | md5sum"
    configurable: no
  - name: ADDITIONAL_ENDPOINT
    description: Endpoint that should be checked additionally
    value:
      method: event_data
      argument: http.url
success: 
  - strategy: output
    argument: "cd69aa437acb1851882aac1a0a43eaf9"
    conclusion: yes
  - strategy: output
    argument: "Not vuln"
    conclusion: no
  - strategy: output
    argument: "Error: "
    conclusion: no
  - strategy: output
    argument: "Vulnerable: "
    conclusion: yes
  - strategy: fallback
    conclusion: no