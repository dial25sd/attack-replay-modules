---
name: CVE-2019-9193-POSTGRES-RCE
module_class: exploit
module_type: standalone 
source: https://github.com/b4keSn4ke/CVE-2019-9193 with modifications for ARF
parameters:
  - name: RHOST
    description: IP of the target machine
    value:
      method: event_data
      argument: dest_ip
  - name: RPORT
    description: Port of the target service
    value:
      method: exists
      argument: 5432
      input:  
        - method: event_data
          argument: dest_port
        - method: scanner
          argument:
            name: PARAM-SCANNER-PORT
            parameters:
              - name: SERVICE_NAME
                value_default: "(?i)postgresql"
  - name: CMD
    description: Command to be executed on target machine
    value_default: "echo attack-replay | md5sum"
  - name: DB
    description: DB to connect to
    value_default: template1
  - name: USER
    description: Name of the user used for connection
    value_default: postgres
  - name: PASSWORD
    description: Password of the user used for connection
    value_default: postgres
success:
  - strategy: output
    argument: "connection to server at .* failed"
    conclusion: no
  - strategy: output
    argument: "cd69aa437acb1851882aac1a0a43eaf9"
    conclusion: yes
  - strategy: output
    argument: "Command executed"
    conclusion: yes
  - strategy: fallback
    conclusion: no