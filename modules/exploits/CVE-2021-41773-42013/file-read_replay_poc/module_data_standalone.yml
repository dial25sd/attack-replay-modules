---
name: CVE-2021-41773-42013-FILE-READ
module_class: exploit
module_type: standalone 
source: ARF
parameters:
  - name: HOST
    description: URL of the potentially vulnerable Apache httpd
    value:
      method: assemble
      argument: "{proto}://{host}:{port}"
      input:
        - name: proto
          method: event_data
          argument: app_proto
        - name: host
          method: event_data
          argument: dest_ip
        - name: port
          method: event_data
          argument: dest_port
  - name: HTTP_PATH
    description: Path of the CGI directory including the path traversal sequence
    value:
      method: event_data
      argument: http.url
  - name: METHOD
    description: HTTP method to use
    value_default: POST
    value:
      method: event_data
      argument: http.http_method
success:
  - strategy: output
    argument: "Failed to connect to host"
    conclusion: no
  - strategy: output
    argument: "root:x:"
    conclusion: yes
  - strategy: output
    argument: "HTTP Response Status Code: 200"
    conclusion: yes
  - strategy: fallback
    conclusion: no