---
name: CVE-2021-41773-42013-RCE
module_class: exploit
module_type: standalone 
source: ARF
parameters:
  - name: HOST
    description: URL of the potentially vulnerable Apache httpd
    value:
      method: assemble
      argument: "{proto}://{host}:{port}"
      input:
        - name: proto
          method: event_data
          argument: app_proto
        - name: host
          method: event_data
          argument: dest_ip
        - name: port
          method: event_data
          argument: dest_port
  - name: HTTP_PATH
    description: Path of the CGI directory including the path traversal sequence
    value:
      method: event_data
      argument: http.url
  - name: METHOD
    description: HTTP method to use
    value_default: POST
    value:
      method: event_data
      argument: http.http_method
  - name: CMD
    description: Command to be executed on success
    value_default: "echo attack-replay | md5sum"
success:
  - strategy: output
    argument: "Failed to connect to host"
    conclusion: no
  - strategy: output
    argument: "cd69aa437acb1851882aac1a0a43eaf9"
    conclusion: yes
  - strategy: fallback
    conclusion: no