---
name: CVE-2018-10561-GPON-AUTH-BYPASS
module_class: exploit
module_type: standalone 
source: https://www.exploit-db.com/exploits/44576 with modifications
parameters:
  - name: RHOST
    description: IP or hostname of the target machine
    value:
      method: assemble
      argument: "{PROTO}://{HOST}"
      input:
        - name: PROTO
          method: event_data
          argument: app_proto
        - name: HOST
          method: event_data
          argument: dest_ip
  - name: HOST_HEADER
    description: Host header to use for the HTTP requests
    value:
      method: exists
      argument:
      input:
        - method: event_data
          argument: http.hostname
        - method: event_data
          argument: dest_ip
  - name: CMD
    description: command to be executed on target system
    value_default: "echo attack-replay | md5sum"
    configurable: no
success:
  - strategy: output
    argument: "cd69aa437acb1851882aac1a0a43eaf9"
    conclusion: yes
  - strategy: fallback
    conclusion: no